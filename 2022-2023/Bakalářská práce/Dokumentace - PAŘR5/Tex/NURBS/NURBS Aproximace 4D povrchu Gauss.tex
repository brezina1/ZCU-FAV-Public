\subsubsection{NURBS aproximace 4D povrchu s užitím Gaussovy funkce}
Opět se jedná o mnou navržený algoritmus dostačující pro účely této práce. Jelikož toto je vesměs nejdůležitější aproximační funkce této práce, matematicky lépe podmíněný algoritmus může být otázkou dalšího výzkumu.\par
Pro aproximaci ve 4D prostoru lze lehkými úpravami použít algoritmus zmíněný v
sekci \nameref{section: gauss surface approximation 3D}. Stačí rozšířit
Gaussovu funkci $f(x,y)$ na funkci $f(x,y,w)$\footnote{Jelikož chceme
    aproximovat souřadnici $z$ (stejně jako ve 3D případě), Gaussova funkce má jako
    třetí vstupní parametr souřadnici $w$} (viz animace č.~\ref{fig:Ukázka Gaussovy
    funkce 4D}), tj.:
\begin{align}
    f(x,y,w) = \exp\left(-\left(\frac{(x - x_0)^2}{2\sigma_x^2} + \frac{(y - y_0)^2}{2\sigma_y^2} + \frac{(w - w_0)^2}{2\sigma_w^2} \right)\right)
\end{align}
kde
\begin{itemize}
    % \item $w_i$ - váhu bodu $\bm{Q}_i$
    \item $x_0$ --- střední hodnota osy $x$
    \item $y_0$ --- střední hodnota osy $y$
    \item $w_0$ --- střední hodnota osy $w$
    \item $\sigma_x$ --- variance osy $x$
    \item $\sigma_y$ --- variance osy $y$
    \item $\sigma_w$ --- variance osy $w$
\end{itemize}
Prvním krokem aproximace je interpolace přes souřadnici $w$, stejně jako
v sekci \nameref{section:interpolace 4D povrchu}. Na takto získané povrchy
pro příslušné hodnoty souřadnice $w$ stačí aplikovat aproximaci ze sekce \nameref{section: gauss surface approximation 3D}.
\par
Ukázka aproximace s různými parametry pro aproximační body $\bf{\bar{Q}}_i$
jsou na animacích č.~\ref{fig:4D aproximace pro různé parametry Gaussovy funkce č. 1},
\ref{fig:4D aproximace pro různé parametry Gaussovy funkce č. 2}, kde:
\begin{align}
    \bf{\bar{Q}}_1 & = [x, y, z, w] = \input{Generated/Gauss Approximace 4D approx bod 1.tex} \\
    \bf{\bar{Q}}_2 & = [x, y, z, w]= \input{Generated/Gauss Approximace 4D approx bod 2.tex}  \\
    \bf{\bar{Q}}_3 & = [x, y, z, w]= \input{Generated/Gauss Approximace 4D approx bod 3.tex}  \\
    \bf{\bar{Q}}_4 & = [x, y, z, w] = \input{Generated/Gauss Approximace 4D approx bod 4.tex}
\end{align}
\ifthenelse{\boolean{includeAnimations}}{
    \begin{landscapeimagepage}
        \vspace*{\fill}
        \begin{figure}[H]
            \centering
            \includeanimation{Generated/Ukázka Gaussovy funkce 4D/frame-}{12.5}{palindrome, height=0.6\textheight}
            % \includeanimation{Generated/4D surface demo 1/frame-}{12.5}{palindrome, height=0.5\textheight}
            \caption{Ukázka průběhu Gaussovy funkce $f(x,y,w)$}
            \label{fig:Ukázka Gaussovy funkce 4D}
        \end{figure}
        \vspace*{\fill}
    \end{landscapeimagepage}}{}
\ifthenelse{\boolean{includeAnimationFrames}}{
    \begin{landscapeimagepage}
        \vspace*{\fill}
        \begin{figure}[H]
            \centering
            \includeanimationframes[\vspace{1cm}]{Generated/Ukázka Gaussovy funkce 4D/frame-}{width=0.28\pdfpageheight}
            \caption{Ukázka průběhu Gaussovy funkce $f(x,y,w)$}
            \label{fig:Ukázka Gaussovy funkce 4D}
        \end{figure}
        \vspace*{\fill}
    \end{landscapeimagepage}}{}

\ifthenelse{\boolean{includeAnimations}}{
    \begin{landscapeimagepage}
        \vspace*{\fill}
        \begin{figure}[H]
            \centering
            \begin{subfigure}{.5\textheight}
                \centering
                \includeanimation{Generated/4D surface gauss approx demo 1/frame-}{12.5}{palindrome, height=0.45\textheight}
                \caption{4D aproximace pro různé parametry Gaussovy funkce č.~1\\(Průhlednost aproximačních bodů odpovídá jejich vzdálenosti v ose $w$)}
                \label{fig:4D aproximace pro různé parametry Gaussovy funkce č. 1}
            \end{subfigure}
            \hspace{2.5cm}
            \begin{subfigure}{.5\textheight}
                \centering
                \includeanimation{Generated/4D surface gauss approx demo 2/frame-}{12.5}{palindrome, height=0.45\textheight}
                \caption{4D aproximace pro různé parametry Gaussovy funkce č.~2\\(Průhlednost aproximačních bodů odpovídá jejich vzdálenosti v ose $w$)}
                \label{fig:4D aproximace pro různé parametry Gaussovy funkce č. 2}
            \end{subfigure}
            \caption{Ukázka aproximace 4D povrchů s užitím Gaussovy funkce}
            \label{fig:Ukázka aproximace 4D povrchů s užitím Gaussovy funkce}
        \end{figure}
        \vspace*{\fill}
    \end{landscapeimagepage}}{}
\ifthenelse{\boolean{includeAnimationFrames}}{
    \begin{landscapeimagepage}
        \vspace*{\fill}
        \begin{figure}[H]
            \centering
            \includeanimationframes[\vspace{1cm}]{Generated/4D surface gauss approx demo 1/frame-}{width=0.28\pdfpageheight}
            \caption{4D aproximace pro různé parametry Gaussovy funkce č.~1\\(Průhlednost aproximačních bodů odpovídá jejich vzdálenosti v ose $w$)}
            \label{fig:4D aproximace pro různé parametry Gaussovy funkce č. 1}
        \end{figure}
        \vspace*{\fill}
    \end{landscapeimagepage}
    \begin{landscapeimagepage}
        \vspace*{\fill}
        \begin{figure}[H]
            \centering
            \includeanimationframes[\vspace{1cm}]{Generated/4D surface gauss approx demo 2/frame-}{width=0.28\pdfpageheight}
            \caption{4D aproximace pro různé parametry Gaussovy funkce č. 2\\(Průhlednost aproximačních bodů odpovídá jejich vzdálenosti v ose $w$)}
            \label{fig:4D aproximace pro různé parametry Gaussovy funkce č. 2}
        \end{figure}
        \vspace*{\fill}
    \end{landscapeimagepage}
}{}